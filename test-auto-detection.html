<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mAIscam Auto-Detection Test Page</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            max-width: 1000px; 
            margin: 0 auto; 
            padding: 20px; 
            line-height: 1.6;
        }
        .test-section { 
            background: #f5f5f5; 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 8px; 
            border-left: 4px solid #007acc;
        }
        .link-list { 
            list-style: none; 
            padding: 0; 
        }
        .link-list li { 
            background: white; 
            margin: 10px 0; 
            padding: 15px; 
            border-radius: 6px; 
            border: 1px solid #ddd;
        }
        .link-list a { 
            color: #007acc; 
            text-decoration: none; 
            font-weight: 500;
        }
        .link-list a:hover { 
            text-decoration: underline; 
        }
        .expected { 
            color: #666; 
            font-size: 0.9em; 
            margin-top: 5px;
        }
        .instructions {
            background: #e8f4fd;
            border: 1px solid #b3d9ff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        code {
            background: #f1f1f1;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Menlo', monospace;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .manual-only { background: #007acc; }
        .not-supported { background: #dc3545; }
    </style>
</head>
<body>
    <h1>🤖 mAIscam Auto-Detection Testing</h1>
    
    <div class="instructions">
        <h2>📋 How to Test Auto-Detection</h2>
        <ol>
            <li><strong>Install the Extension:</strong> Load the built extension from <code>.output/chrome-mv3/</code> in Chrome Developer Mode</li>
            <li><strong>Test URL Detection:</strong> Click the links below in new tabs and observe:
                <ul>
                    <li>🔍 Extension badge changes based on site type</li>
                    <li>🤖 Sidebar shows auto-detected site type</li>
                    <li>🔘 "Manual Analysis" badge shows analysis requires clicking button</li>
                </ul>
            </li>
            <li><strong>Test Tab Switching:</strong> After opening multiple tabs:
                <ul>
                    <li>🔄 Switch between tabs using Ctrl+Tab or clicking tab headers</li>
                    <li>📱 Observe sidebar updates to show current tab's detection</li>
                    <li>🏷️ Watch extension badge change for each tab</li>
                    <li>🔘 Analyze button text updates based on detected site type</li>
                </ul>
            </li>
            <li><strong>Test Manual Analysis:</strong> Click the analyze button to start analysis:
                <ul>
                    <li>📧 Gmail: Button shows "🛡️ Analyze Gmail Email"</li>
                    <li>👥 Facebook: Button shows "📱 Scan Facebook Post"</li>
                    <li>🌐 Websites: Button shows "🛡️ Analyze Website"</li>
                </ul>
            </li>
            <li><strong>Check Console:</strong> Open DevTools and watch for auto-detection logs with <code>[AUTO-DETECT]</code> prefix</li>
        </ol>
    </div>

    <div class="warning">
        <strong>⚠️ Note:</strong> Some test links may redirect or require authentication. The auto-detection should still work based on the initial URL pattern.
    </div>

    <div class="test-section">
        <h2>📧 Email Platform Testing</h2>
        <p>These should be detected as <strong>"email"</strong> type with Gmail platform.</p>
        <ul class="link-list">
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://mail.google.com/" target="_blank">Gmail - Main Interface</a>
                <div class="expected">Expected: email/gmail, manual analysis, confidence 95%</div>
            </li>
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://mail.google.com/mail/u/0/#inbox" target="_blank">Gmail - Inbox</a>
                <div class="expected">Expected: email/gmail, manual analysis, confidence 95%</div>
            </li>
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://mail.google.com/mail/u/0/#compose" target="_blank">Gmail - Compose</a>
                <div class="expected">Expected: email/gmail, manual analysis, confidence 95%</div>
            </li>
        </ul>
    </div>

    <div class="test-section">
        <h2>👥 Social Media Platform Testing</h2>
        <p>These should be detected as <strong>"social"</strong> type.</p>
        <ul class="link-list">
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://www.facebook.com/" target="_blank">Facebook - Main Feed</a>
                <div class="expected">Expected: social/facebook, manual analysis, confidence 95%</div>
            </li>
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://www.facebook.com/marketplace" target="_blank">Facebook - Marketplace</a>
                <div class="expected">Expected: social/facebook, manual analysis, confidence 95%</div>
            </li>
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://twitter.com/" target="_blank">Twitter/X - Main Feed</a>
                <div class="expected">Expected: social/other, manual analysis, confidence 80%</div>
            </li>
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://www.instagram.com/" target="_blank">Instagram</a>
                <div class="expected">Expected: social/other, manual analysis, confidence 80%</div>
            </li>
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://www.linkedin.com/" target="_blank">LinkedIn</a>
                <div class="expected">Expected: social/other, manual analysis, confidence 80%</div>
            </li>
        </ul>
    </div>

    <div class="test-section">
        <h2>🌐 Website Testing</h2>
        <p>These should be detected as <strong>"website"</strong> type.</p>
        <ul class="link-list">
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://www.amazon.com/" target="_blank">Amazon - E-commerce</a>
                <div class="expected">Expected: website/generic, manual analysis, confidence 70%</div>
            </li>
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://www.paypal.com/" target="_blank">PayPal - Financial</a>
                <div class="expected">Expected: website/generic, manual analysis, confidence 70%</div>
            </li>
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://www.apple.com/" target="_blank">Apple - Corporate</a>
                <div class="expected">Expected: website/generic, manual analysis, confidence 70%</div>
            </li>
            <li>
                <span class="status-indicator manual-only"></span>
                <a href="https://www.microsoft.com/" target="_blank">Microsoft - Corporate</a>
                <div class="expected">Expected: website/generic, manual analysis, confidence 70%</div>
            </li>
        </ul>
    </div>

    <div class="test-section">
        <h2>🚫 Excluded URLs Testing</h2>
        <p>These should NOT trigger auto-detection or analysis.</p>
        <ul class="link-list">
            <li>
                <span class="status-indicator not-supported"></span>
                <a href="chrome://extensions/" target="_blank">Chrome Extensions Page</a>
                <div class="expected">Expected: No detection, confidence 0%</div>
            </li>
            <li>
                <span class="status-indicator not-supported"></span>
                <a href="chrome://settings/" target="_blank">Chrome Settings</a>
                <div class="expected">Expected: No detection, confidence 0%</div>
            </li>
            <li>
                <span class="status-indicator not-supported"></span>
                <a href="http://localhost:3000/" target="_blank">Localhost Development</a>
                <div class="expected">Expected: No detection, confidence 0%</div>
            </li>
        </ul>
    </div>

    <div class="test-section">
        <h2>🧪 Test Validation Checklist</h2>
        <h3>Visual Indicators:</h3>
        <ul>
            <li>📧 <strong>Email sites:</strong> Blue badge with email icon</li>
            <li>👥 <strong>Social sites:</strong> Purple badge with people icon</li>
            <li>🌐 <strong>Websites:</strong> Green badge with globe icon</li>
        </ul>
        
        <h3>Sidebar Behavior:</h3>
        <ul>
            <li>✅ Site type is auto-detected and displayed</li>
            <li>✅ Confidence percentage is shown</li>
            <li>✅ Platform information is displayed (gmail, facebook, etc.)</li>
            <li>✅ "Manual Analysis" badge appears for all sites</li>
            <li>✅ Analyze button text updates based on detected type</li>
        </ul>
        
        <h3>Console Logs to Watch For:</h3>
        <ul>
            <li><code>🔍 [AUTO-DETECT] Tab X detected as: ...</code> (URL change detection)</li>
            <li><code>🔄 [AUTO-DETECT] Tab X activated (switched to)</code> (tab switching)</li>
            <li><code>🔧 [AUTO-DETECT] Settings loaded from storage: ...</code> (initialization)</li>
            <li><code>🔄 [SIDEBAR] Received tab switch notification: ...</code> (sidebar updates)</li>
            <li><code>🛡️ Manual analysis triggered by user click</code> (when analyze button clicked)</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>🎯 Expected Manual Analysis Behavior</h2>
        <p><strong>Analysis should only trigger when:</strong></p>
        <ul>
            <li>🖱️ User manually clicks the "Analyze" button</li>
            <li>🎯 Button text reflects the detected site type</li>
            <li>📧 Gmail: "🛡️ Analyze Gmail Email"</li>
            <li>👥 Facebook: "📱 Scan Facebook Post"</li>
            <li>🌐 Websites: "🛡️ Analyze Website"</li>
        </ul>
        
        <p><strong>Auto-detection (site type recognition) should work:</strong></p>
        <ul>
            <li>✅ When navigating to a new page (significant URL change)</li>
            <li>✅ When switching between existing tabs</li>
            <li>✅ For all supported site types (Gmail, Facebook, websites)</li>
            <li>✅ Extension badge updates immediately</li>
            <li>✅ Sidebar shows detected type and confidence</li>
        </ul>
        
        <p><strong>Auto-detection should NOT work for:</strong></p>
        <ul>
            <li>❌ Excluded URLs (chrome://, localhost, etc.)</li>
            <li>❌ Insignificant URL changes (hash navigation, etc.)</li>
        </ul>
    </div>

    <script>
        // Add some JavaScript to help with testing
        console.log('🧪 mAIscam Auto-Detection Test Page Loaded');
        console.log('📝 To test: Click links above and watch for auto-detection in extension');
        
        // Track clicks for testing purposes
        document.addEventListener('click', (e) => {
            if (e.target.tagName === 'A' && e.target.href) {
                console.log('🔗 Test link clicked:', e.target.href);
                console.log('🔍 Expected detection type:', e.target.parentElement.querySelector('.expected')?.textContent);
            }
        });
    </script>
</body>
</html>
